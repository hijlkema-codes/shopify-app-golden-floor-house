(()=>{var u=(e,t="generic",r=void 0,...a)=>{let s=e.querySelector("[data-errors]"),o=s.content.querySelector(`[data-error="${t}"]`);o||(o=s.content.querySelector("[data-error='generic']"));let d=o.cloneNode(!0);e.appendChild(d),e.setAttribute("aria-invalid","true"),r&&console.warn(r,...a)},m=e=>{e.querySelectorAll("[data-error]").forEach(r=>{r.remove()}),e.setAttribute("aria-invalid","false")};var b={parse_float:e=>parseFloat(e),parse_boolean:e=>["true","1","on","yes"].includes(e.toLowerCase()),to_currency:e=>new Intl.NumberFormat(void 0,{currency:"EUR",style:"currency"}).format(e),to_currency_unsigned:e=>new Intl.NumberFormat(void 0,{currency:"EUR",style:"currency",currencyDisplay:"code"}).format(e).replace("EUR","").trim(),from_cents:e=>e/100},i=(e,t)=>t.reduce((r,a)=>b[a]?b[a](r):r,e);var c=(e,t)=>{let r=document.querySelector(`[data-value-target="${e}"]`);if(r)if(r.hasAttribute("data-value-target-attribute")){let a=r.getAttribute("data-value-target-attribute");r.setAttribute(a,t);return}else r.innerHTML=t},n=(e,t,r=[])=>{let a="";return e.hasAttribute(t)&&(a=e.getAttribute(t)),e.dataset[t]&&(a=e.dataset[t]),i(a,r)},y=(e,t=[])=>{let r="";return e.tagName==="INPUT"&&(r=e.value),i(r,t)},l=(e,t)=>{t.forEach(r=>{e.addEventListener(r.type,r.handler)})},f=(e,t=!0)=>{t?(e.setAttribute("disabled",!0),e.classList.add("loading"),e.setAttribute("aria-busy","true")):(e.removeAttribute("disabled"),e.classList.remove("loading"),e.setAttribute("aria-busy","false"))};var g=(e,t)=>Math.round(e*(1+t/100)),E=(e,t)=>Math.ceil(e/t);var S=async(e,t)=>(await fetch(window.Shopify.routes.root+"cart/add.js",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({items:[{id:e,quantity:t}]})})).json();var q="cart-drawer",w=()=>{let e=document.querySelector(q);e&&(e.update?.(),e.show?.())};var v="package-calculator",p=class extends HTMLElement{connectedCallback(){super.connectedCallback?.(),l(this,[{type:"input",handler:this.#e.bind(this)}]),l(this.querySelector("form"),[{type:"submit",handler:this.#t.bind(this)}])}#e(t){t.preventDefault(),this.setAttribute("aria-expanded","true");let r=t.target.valueAsNumber;if(!this.#s(r)){this.#o(1);return}let a=this.#r(r);this.#a(a)}async#t(t){t.preventDefault(),m(this);let r=y(this.querySelector('input[name="square_meters"]'),["parse_int"]),a=n(this,"productId"),s=n(this.querySelector('input[name="quantity"]'),"value",["parse_int"]);if(!r){u(this,"missing-fields","Surface area is required.",{squareMeters:r});return}if(!a){u(this,"generic","Product ID not found.");return}if(!s){u(this,"missing-fields","Quantity is required.",{quantity:s});return}let o=[];document.documentElement.dispatchEvent(new CustomEvent("cart:bundled-sections",{bubbles:!0,detail:{sections:o}})),f(this),await S(a,s);let d=await fetch(`?sections=${o.join(",")}`).then(_=>_.json()),h=await(await fetch(`${theme.routes.cart_url}`,{...theme.utils.fetchConfig()})).json();h.sections=d,theme.pubsub.publish(theme.pubsub.PUB_SUB_EVENTS.cartUpdate,{source:"product-form",cart:h}),f(this,!1),w()}#r(t){return g(t,n(this,"cutoffPercentage",["parse_float"]))}#a(t){let r=n(this,"squareMetersPerPackage",["parse_float"]),a=n(this,"productPrice",["parse_float","from_cents"]),s=E(t,r),o=i(s*a,[this.#n()]);c("selected-packs",s),c("entered-surface-area",t),c("totals",o),c("quantity",s)}#s(t){return!(!t||isNaN(t)||t<1)}#o(){this.setAttribute("aria-expanded","false")}#n(){return n(this,"showCurrency",["parse_boolean"])?"to_currency":"to_currency_unsigned"}};customElements.get(v)||customElements.define(v,p);})();
